#Gasgiant Shellworld Jobs
ssh_gas_collector = {
	category = specialist
	building_icon = building_gas_extractors

	tags = { exotic_gases strategic_resource }

	possible_pre_triggers = {
		has_owner = yes
		is_being_purged = no
		is_being_assimilated = no
		is_sapient = yes
	}

	possible_precalc = can_fill_specialist_job
	possible = {
		complex_specialist_job_check_trigger = yes
	}

	resources = {
		category = planet_miners
		produces = {
			sr_hydrogen = 5
			exotic_gases = 2
		}
		upkeep = {
			consumer_goods = 1.5
		}
		#inline_script = "output/researcher_output"
	}

	#overlord_resources = {
	#}

	weight = {
		weight = @specialist_job_weight
		mult = value:job_weights_modifier|JOB|ssh_gas_collector|RESOURCE|exotic_gases|
		mult = value:job_weights_modifier|JOB|ssh_gas_collector|RESOURCE|sr_hydrogen|
		modifier = {
			factor = 0.2
			has_citizenship_rights = no
			NOT = { has_trait = trait_mechanical }
		}
		modifier = {
			factor = 0.1
			can_take_servant_job = yes
		}
		modifier = {
			factor = 0.8
			is_enslaved = yes
			has_slavery_type = { type = slavery_indentured }
		}
	}

	inline_script = "jobs/automodding_priority_minerals" ### Might make an own inline script at some point

	promotion = {
		time = @standard_promotion_time
		effect = {
			pop_amount_change_category = {
				CATEGORY = specialist
				AMOUNT = local_pop_amount
			}
		}
	}
}


# Stellar Hoop Jobs
ssh_stellar_technician = {
	category = worker
	swappable_data = {
		default = {
			condition_string = WORKER_JOB_TRIGGER
			building_icon = building_energy_grid
		}
	}

	tags = { energy }

	possible_pre_triggers = {
		has_owner = yes
		is_being_purged = no
		is_being_assimilated = no
		is_sapient = yes
	}

	possible_precalc = can_fill_worker_job
	possible = {
		hidden_trigger = { exists = owner }
		owner = {
			is_gestalt = no
		}
	}

	resources = {
		category = planet_technician
		produces = {
			energy = 12 #2x regular technician
		}
		produces = {
			trigger = {
				exists = owner
				owner = {
					is_robot_empire = yes
				}
			}
			energy = 2
		}
		produces = {
			trigger = {
				planet = {
					has_planet_flag = has_energy_requisitorium
				}
			}
			energy = @requisitorium_energy_reduction
		}
	}
	overlord_resources = {
		category = planet_requisitioned_energy
		produces = {
			trigger = {
				planet = {
					has_planet_flag = has_energy_requisitorium
				}
			}
			energy = @requisitorium_energy_overlord
		}
	}

	weight = {
		weight = @worker_job_weight
		mult = value:job_weights_modifier|JOB|ssh_stellar_technician|RESOURCE|energy|
		modifier = {
			factor = 100
			OR = {
				is_non_sapient_robot = yes
				is_shackled_robot = yes
			}
			can_take_servant_job = no
			can_fill_specialist_job_trigger = no
		}
		modifier = {
			factor = 8
			is_enslaved = yes
			can_take_servant_job = no
			OR = {
				has_trait = trait_syncretic_proles
				has_trait = trait_robot_superconductive
				has_trait = trait_ingenious
			}
		}
		modifier = {
			factor = 2
			OR = {
				is_non_sapient_robot = yes
				is_shackled_robot = yes
			}
			can_take_servant_job = no
		}
		modifier = {
			factor = 0.25
			can_take_servant_job = yes
		}
		modifier = {
			factor = 5
			has_trait = trait_cyborg_creed_of_labor
		}
	}

	inline_script = "jobs/automodding_priority_energy"

	promotion = {
		time = @standard_promotion_time
		effect = {
			pop_amount_change_category = {
				CATEGORY = worker
				AMOUNT = local_pop_amount
			}
		}
	}
}

ssh_stellar_lifter = {
	category = worker
	swappable_data = {
		default = {
			condition_string = WORKER_JOB_TRIGGER
			building_icon = building_mineral_purification_plant
		}
	}

	tags = { minerals }

	possible_pre_triggers = {
		has_owner = yes
		is_being_purged = no
		is_being_assimilated = no
		is_sapient = yes
	}

	possible_precalc = can_fill_worker_job
	possible = {
		hidden_trigger = { exists = owner }
		owner = {
			is_gestalt = no
		}
	}

	resources = {
		category = planet_miners
		produces = {
			sr_hydrogen = 15
			minerals = 10
		}
		produces = {
			trigger = {
				planet = {
					has_planet_flag = has_material_requisitorium
				}
			}
			minerals = @requisitorium_minerals_reduction
		}
	}
	overlord_resources = {
		category = planet_requisitioned_minerals
		produces = {
			trigger = {
				planet = {
					has_planet_flag = has_material_requisitorium
				}
			}
			minerals = @requisitorium_minerals_overlord
		}
	}

	triggered_planet_modifier = {
		# Gives some Stability per "Mining Guild" Councilor level.
		potential = {
			has_councilor = { COUNCILOR = "councilor_mining_guilds" }
		}
		planet_stability_add = @councilor_mining_guilds_miner_stability
		mult = value:councilor_level|TYPE|councilor_mining_guilds|
	}

	weight = {
		weight = @worker_job_weight
		mult = value:job_weights_modifier|JOB|ssh_stellar_lifter|RESOURCE|minerals|
		mult = value:job_weights_modifier|JOB|ssh_stellar_lifter|RESOURCE|sr_hydrogen|
		modifier = {
			factor = 100
			OR = {
				is_non_sapient_robot = yes
				is_shackled_robot = yes
			}
			can_take_servant_job = no
			can_fill_specialist_job_trigger = no
		}
		modifier = {
			factor = 8
			is_enslaved = yes
			can_take_servant_job = no
			OR = {
				has_trait = trait_syncretic_proles
				has_trait = trait_robot_power_drills
				has_trait = trait_industrious
			}
		}
		modifier = {
			factor = 2
			OR = {
				is_non_sapient_robot = yes
				is_shackled_robot = yes
			}
			can_take_servant_job = no
		}
		modifier = {
			factor = 0.25
			can_take_servant_job = yes
		}
		modifier = {
			factor = 5
			has_trait = trait_cyborg_creed_of_labor
		}
	}

	inline_script = "jobs/automodding_priority_minerals"

	promotion = {
		time = @standard_promotion_time
		effect = {
			pop_amount_change_category = {
				CATEGORY = worker
				AMOUNT = local_pop_amount
			}
		}
	}
}

# Cultrobium Producer
ssh_cultrobium_foundry = {
	category = specialist
	building_icon = building_foundry_1

	tags = { alloys }

	possible_pre_triggers = {
		has_owner = yes
		is_being_purged = no
		is_being_assimilated = no
		is_sapient = yes
	}

	possible_precalc = can_fill_specialist_job
	possible = {
		complex_specialist_job_check_trigger = yes
	}

	resources = {
		category = planet_metallurgists
		produces = {
			sr_cultrobium = 5
		}
		upkeep = {
			minerals = 6
		}
		# Might add this later
		#produces = {
		#	trigger = {
		#		planet = {
		#			has_planet_flag = has_material_requisitorium
		#		}
		#	}
		#	sr_cultrobium = @requisitorium_alloys_reduction
		#}
		#upkeep = {
		#	trigger = {
		#		planet = {
		#			has_planet_flag = has_material_requisitorium
		#		}
		#	}
		#	minerals = 2
		#}
	}

	#overlord_resources = {
	#}

	weight = {
		weight = @specialist_job_weight
		mult = value:job_weights_modifier|JOB|ssh_cultrobium_foundry|RESOURCE|sr_cultrobium|
		modifier = {
			factor = 0.2
			has_citizenship_rights = no
			NOT = { has_trait = trait_mechanical }
		}
		modifier = {
			factor = 0.1
			can_take_servant_job = yes
		}
		modifier = {
			factor = 0.8
			is_enslaved = yes
			has_slavery_type = { type = slavery_indentured }
		}
	}

	#inline_script = "jobs/automodding_priority_cultrobium" ### Might make an own inline script at some point

	promotion = {
		time = @standard_promotion_time
		effect = {
			pop_amount_change_category = {
				CATEGORY = specialist
				AMOUNT = local_pop_amount
			}
		}
	}
}

# Black Hole Decompressor
ssh_matter_decompressor = {
	category = worker
	swappable_data = {
		default = {
			condition_string = WORKER_JOB_TRIGGER
			building_icon = building_mineral_purification_plant
		}
	}

	tags = { minerals }

	possible_pre_triggers = {
		has_owner = yes
		is_being_purged = no
		is_being_assimilated = no
		is_sapient = yes
	}

	possible_precalc = can_fill_worker_job
	possible = {
		hidden_trigger = { exists = owner }
		owner = {
			is_gestalt = no
		}
	}

	resources = {
		category = planet_miners
		produces = {
			minerals = 6
			sr_dark_matter = 1 #2 Pre 4.0
		}
		produces = {
			trigger = {
				planet = {
					has_planet_flag = has_material_requisitorium
				}
			}
			minerals = @requisitorium_minerals_reduction
		}
	}

	triggered_planet_modifier = {
		# Gives some Stability per "Mining Guild" Councilor level.
		potential = {
			has_councilor = { COUNCILOR = "councilor_mining_guilds" }
		}
		planet_stability_add = @councilor_mining_guilds_miner_stability
		mult = value:councilor_level|TYPE|councilor_mining_guilds|
	}

	overlord_resources = {
		category = planet_requisitioned_minerals
		produces = {
			trigger = {
				planet = {
					has_planet_flag = has_material_requisitorium
				}
			}
			minerals = @requisitorium_minerals_overlord
		}
	}

	weight = {
		weight = @worker_job_weight
		mult = value:job_weights_modifier|JOB|ssh_matter_decompressor|RESOURCE|minerals|
		mult = value:job_weights_modifier|JOB|ssh_matter_decompressor|RESOURCE|sr_dark_matter|
		modifier = {
			factor = 100
			OR = {
				is_non_sapient_robot = yes
				is_shackled_robot = yes
			}
			can_take_servant_job = no
			can_fill_specialist_job_trigger = no
		}
		modifier = {
			factor = 8
			is_enslaved = yes
			can_take_servant_job = no
			OR = {
				has_trait = trait_syncretic_proles
				has_trait = trait_robot_power_drills
				has_trait = trait_industrious
			}
		}
		modifier = {
			factor = 2
			OR = {
				is_non_sapient_robot = yes
				is_shackled_robot = yes
			}
			can_take_servant_job = no
		}
		modifier = {
			factor = 0.25
			can_take_servant_job = yes
		}
		modifier = {
			factor = 5
			has_trait = trait_cyborg_creed_of_labor
		}
	}

	inline_script = "jobs/automodding_priority_minerals"

	promotion = {
		time = @standard_promotion_time
		effect = {
			pop_amount_change_category = {
				CATEGORY = worker
				AMOUNT = local_pop_amount
			}
		}
	}
}

# Conmat Biologist
ssh_conmat_biologist = {
	category = specialist
	building_icon = building_ssh_conmat_lab

	tags = { strategic_resource }

	possible_pre_triggers = {
		has_owner = yes
		is_being_purged = no
		is_being_assimilated = no
		is_sapient = yes
	}

	possible_precalc = can_fill_specialist_job
	possible = {
		complex_specialist_job_check_trigger = yes
	}

	resources = {
		category = planet_biologists #planet_jobs
		produces = {
			sr_conscious_matter = 5
		}
		upkeep = {
			food = 8 #originally used to be 15
			volatile_motes = 0.5
		}
	}

	#overlord_resources = {
	#}

	weight = {
		weight = @specialist_job_weight
		mult = value:job_weights_modifier|JOB|ssh_conmat_biologist|RESOURCE|sr_conscious_matter|
		modifier = {
			factor = 0.2
			has_citizenship_rights = no
			NOT = { has_trait = trait_mechanical }
		}
		modifier = {
			factor = 0.1
			can_take_servant_job = yes
		}
		modifier = {
			factor = 0.8
			is_enslaved = yes
			has_slavery_type = { type = slavery_indentured }
		}
	}

	#inline_script = "jobs/automodding_priority_conmat" ### Might make an own inline script at some point

	promotion = {
		time = @standard_promotion_time
		effect = {
			pop_amount_change_category = {
				CATEGORY = specialist
				AMOUNT = local_pop_amount
			}
		}
	}
}

# Scrap Collector
ssh_scrap_collector = {
	category = worker
	swappable_data = {
		default = {
			condition_string = WORKER_JOB_TRIGGER
			building_icon = building_mineral_purification_plant
		}
	}

	tags = { minerals }

	possible_pre_triggers = {
		has_owner = yes
		is_being_purged = no
		is_being_assimilated = no
		is_sapient = yes
	}

	possible_precalc = can_fill_worker_job
	possible = {
		hidden_trigger = { exists = owner }
		owner = {
			is_gestalt = no
		}
	}

	resources = {
		category = planet_jobs
		produces = {
			alloys = 5
			minerals = 7
			engineering_research = 1
		}
		produces = {
			trigger = {
				planet = {
					has_planet_flag = has_material_requisitorium
				}
			}
			minerals = @requisitorium_minerals_reduction
		}
	}

	triggered_planet_modifier = {
		# Gives some Stability per "Mining Guild" Councilor level.
		potential = {
			has_councilor = { COUNCILOR = "councilor_mining_guilds" }
		}
		planet_stability_add = @councilor_mining_guilds_miner_stability
		mult = value:councilor_level|TYPE|councilor_mining_guilds|
	}

	overlord_resources = {
		category = planet_requisitioned_minerals
		produces = {
			trigger = {
				planet = {
					has_planet_flag = has_material_requisitorium
				}
			}
			minerals = @requisitorium_minerals_overlord
		}
	}

	weight = {
		weight = @worker_job_weight
		mult = value:job_weights_modifier|JOB|ssh_scrap_collector|RESOURCE|minerals|
		mult = value:job_weights_modifier|JOB|ssh_scrap_collector|RESOURCE|alloys|
		modifier = {
			factor = 100
			OR = {
				is_non_sapient_robot = yes
				is_shackled_robot = yes
			}
			can_take_servant_job = no
			can_fill_specialist_job_trigger = no
		}
		modifier = {
			factor = 8
			is_enslaved = yes
			can_take_servant_job = no
			OR = {
				has_trait = trait_syncretic_proles
				has_trait = trait_robot_power_drills
				has_trait = trait_industrious
			}
		}
		modifier = {
			factor = 2
			OR = {
				is_non_sapient_robot = yes
				is_shackled_robot = yes
			}
			can_take_servant_job = no
		}
		modifier = {
			factor = 0.25
			can_take_servant_job = yes
		}
		modifier = {
			factor = 5
			has_trait = trait_cyborg_creed_of_labor
		}
	}

	inline_script = "jobs/automodding_priority_minerals"

	promotion = {
		time = @standard_promotion_time
		effect = {
			pop_amount_change_category = {
				CATEGORY = worker
				AMOUNT = local_pop_amount
			}
		}
	}
}


##### Purge #####
ssh_purge_conmat = {
	category = purge
	#purge = purge_conmat
	first_come_first_served = yes
	is_capped_by_modifier = no

	demotion = {
		time = 0
		effect = {
			pop_amount_change_category = {
				CATEGORY = purge
				AMOUNT = local_pop_amount
			}
		}
	}

	tags = { }

	ignores_sapience = yes

	possible_pre_triggers = {
		has_owner = yes
		is_robotic = no
		is_being_purged = yes
	}

	possible = {
		OR = {
			has_purge_type = { type = purge_conmat country = owner }
			has_pop_group_flag = event_purge
		}
		#is_lithoid = no
	}

	resources = {
		category = planet_jobs
		produces = {
			sr_conscious_matter = 1
		}
		produces = {
			trigger = {
				exists = owner
				owner = { has_valid_civic = civic_fanatic_purifiers }
			}
			unity = 2
		}
		produces = {
			trigger = {
				exists = owner
				owner = { has_valid_civic = civic_hive_devouring_swarm }
			}
			society_research = 2
		}
		produces = {
			trigger = {
				planet = { has_active_building = building_ssh_conmat_lab }
			}
			sr_conscious_matter = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_origin = origin_evolutionary_predators }
		}
		custom_tooltip = evolutionary_predators_pops_tt
	}

	weight = {
		weight = @special_job_weight

		modifier = {
			factor = 220 # brings @special_job_weight up to 2.2
			exists = planet
			exists = planet.controller
			OR = {
				has_pop_group_flag = event_purge
				planet.controller = {
					OR = {
						is_country_type = swarm
						is_country_type = ai_empire
					}
				}
			}
		}

		modifier = {
			factor = 9999 # u die when flagged
			has_pop_group_flag = event_purge
		}

		modifier = {
			factor = 9999 # u die when crisis'd
			exists = planet
			exists = planet.controller
			planet.controller = {
				OR = {
					is_country_type = swarm
					is_country_type = ai_empire
					# extradimensionals just bombard you
				}
			}
		}
	}
}

