ssh_tech_microscale_engineering = {
	cost = @ssh_tech_microscale_1_cost #-> same as ringworlds/mega engineering tech
	area = physics
	tier = 3
	category = { particles }
	prerequisites = { "tech_mega_engineering" }
	potential = {
		OR = {
			#has_ascension_perk = ap_galactic_hyperstructures
			has_technology = tech_mega_engineering
			has_country_flag = exodus_crisis_country
		}
	}
	weight = @tier3weight2
	#is_dangerous = yes
	is_rare = yes
	prereqfor_desc = {
		ship = {
			title = "ssh_needed_for_subatomic_manipulation"
			#desc = "ssh_tech_matrioshka_worlds_desc"
		}
	}

	modifier = {
		country_physics_tech_research_speed = 0.1
		country_society_tech_research_speed = 0.1
	}

	weight_modifier = {
		modifier = {
			factor = @ap_technological_ascendancy_rare_tech
			has_ascension_perk = ap_technological_ascendancy
		}
		modifier = { 
			factor = value:tech_weight_likelihood 
			has_trait_in_council = { TRAIT = leader_trait_expertise_particles } 
		}
		modifier = {
			factor = @federation_perk_factor
			has_federation = yes
			federation = {
				has_federation_perk = rare_tech_boost
				any_member = { has_technology = ssh_tech_microscale_engineering }
			}
		}
		modifier = { 
			factor = 1.5
			has_technology = tech_nanite_transmutation
		}
		modifier = { 
			factor = 0 
			has_utopia = no 
		}
	}

	ai_weight = {
		factor = 100
		#modifier = {
		#	factor = 10
		#	has_ascension_perk = ap_engineered_evolution
		#}
		#modifier = {
		#	factor = 10
		#	has_ascension_perk = ap_the_flesh_is_weak
		#}
		modifier = { 
			factor = value:tech_weight_likelihood 
			has_trait_in_council = { TRAIT = leader_trait_expertise_particles } 
		}
		modifier = { 
			factor = 0 
			has_utopia = no 
		}
	}
}

ssh_tech_molecular_bond_manipulation = {
	cost = @ssh_tech_microscale_3_cost
	area = physics
	tier = 3
	category = { particles }
	prerequisites = { "ssh_tech_advanced_dna_resequencing" }
	weight = @tier3weight2
	is_rare = yes
	prereqfor_desc = {
		ship = {
			title = "ssh_needed_for_subatomic_manipulation"
			#desc = "ssh_tech_matrioshka_worlds_desc"
		}
	}

	modifier = {
		country_physics_tech_research_speed = 0.05
		planet_jobs_alloys_produces_mult = 0.15
		planet_jobs_consumer_goods_produces_mult = 0.15
		planet_jobs_rare_crystals_produces_mult = 0.15
		planet_jobs_volatile_motes_produces_mult = 0.15
	}

	weight_modifier = {
		modifier = {
			factor = @ap_technological_ascendancy_rare_tech
			has_ascension_perk = ap_technological_ascendancy
		}
		modifier = { 
			factor = value:tech_weight_likelihood 
			has_trait_in_council = { TRAIT = leader_trait_expertise_particles } 
		}
		modifier = {
			factor = @federation_perk_factor
			has_federation = yes
			federation = {
				has_federation_perk = rare_tech_boost
				any_member = { has_technology = ssh_tech_molecular_bond_manipulation }
			}
		}
		modifier = { 
			factor = 0 
			has_utopia = no 
		}
	}

	ai_weight = {
		factor = 100
		modifier = { 
			factor = value:tech_weight_likelihood 
			has_trait_in_council = { TRAIT = leader_trait_expertise_particles } 
		}
		modifier = { 
			factor = 0 
			has_utopia = no 
		}
	}
}

ssh_tech_atomic_manipulation = {
	cost = @ssh_tech_microscale_4_cost
	area = physics
	tier = 4
	category = { particles }
	prerequisites = { "ssh_tech_molecular_bond_manipulation" "tech_nanite_transmutation" }
	weight = @tier5weight1
	is_rare = yes
	#prereqfor_desc = {
	#	ship = {
	#		title = "ssh_needed_for_subatomic_manipulation"
	#	}
	#}

	modifier = {
		country_physics_tech_research_speed = 0.05
		megastructure_build_speed_mult = 0.1
		country_nanites_produces_mult = 0.1
	}

	weight_modifier = {
		modifier = {
			factor = @ap_technological_ascendancy_rare_tech
			has_ascension_perk = ap_technological_ascendancy
		}
		modifier = { 
			factor = value:tech_weight_likelihood 
			has_trait_in_council = { TRAIT = leader_trait_expertise_particles } 
		}
		modifier = {
			factor = @federation_perk_factor
			has_federation = yes
			federation = {
				has_federation_perk = rare_tech_boost
				any_member = { has_technology = ssh_tech_atomic_manipulation }
			}
		}
		modifier = { 
			factor = 0 
			has_utopia = no 
		}
	}

	ai_weight = {
		factor = 100
		modifier = { 
			factor = value:tech_weight_likelihood 
			has_trait_in_council = { TRAIT = leader_trait_expertise_particles } 
		}
		modifier = { 
			factor = 0 
			has_utopia = no 
		}
	}
}

ssh_tech_nuclei_modification = {
	cost = @ssh_tech_microscale_5_cost
	area = physics
	tier = 4
	category = { particles }
	prerequisites = { "ssh_tech_atomic_manipulation" "tech_zero_point_power" }
	weight = @tier4weight2
	is_rare = yes
	prereqfor_desc = {
		ship = {
			title = "ssh_tech_nuclei_modification_tooltip"
		}
	}

	modifier = {
		country_physics_tech_research_speed = 0.05
	}

	weight_modifier = {
		modifier = {
			factor = @ap_technological_ascendancy_rare_tech
			has_ascension_perk = ap_technological_ascendancy
		}
		modifier = { 
			factor = value:tech_weight_likelihood 
			has_trait_in_council = { TRAIT = leader_trait_expertise_particles } 
		}
		modifier = {
			factor = @federation_perk_factor
			has_federation = yes
			federation = {
				has_federation_perk = rare_tech_boost
				any_member = { has_technology = ssh_tech_nuclei_modification }
			}
		}
		modifier = { 
			factor = 0 
			has_utopia = no 
		}
	}

	ai_weight = {
		factor = 100
		modifier = { 
			factor = value:tech_weight_likelihood 
			has_trait_in_council = { TRAIT = leader_trait_expertise_particles } 
		}
		modifier = { 
			factor = 0 
			has_utopia = no 
		}
	}
}

ssh_tech_elementary_tampering = {
	cost = @ssh_tech_microscale_6_cost
	area = physics
	tier = 5
	category = { field_manipulation }
	prerequisites = { "ssh_tech_nuclei_modification" "tech_mine_dark_matter" }
	weight = @tier5weight1
	is_dangerous = yes
	prereqfor_desc = {
		ship = {
			title = "ssh_certain_worth_it"
			#desc = "ssh_tech_matrioshka_worlds_desc"
		}
	}

	modifier = {
		country_physics_tech_research_speed = 0.15
		ship_ftl_jumpdrive_range_mult = 0.1
	}

	weight_modifier = {
		modifier = {
			factor = @ap_technological_ascendancy_rare_tech
			has_ascension_perk = ap_technological_ascendancy
		}
		modifier = { 
			factor = value:tech_weight_likelihood
			has_trait_in_council = { TRAIT = leader_trait_expertise_field_manipulation } 
		}
		modifier = { 
			factor = 0 
			has_utopia = no 
		}
	}

	ai_weight = {
		factor = 100
		modifier = { 
			factor = value:tech_weight_likelihood 
			has_trait_in_council = { TRAIT = leader_trait_expertise_field_manipulation } 
		}
		modifier = { 
			factor = 0 
			has_utopia = no 
		}
	}
}

ssh_tech_reality_shaping = {
	cost = @ssh_tech_microscale_7_cost
	area = physics
	tier = 5
	category = { particles }
	#prerequisites = { "ssh_tech_elementary_tampering" }
	potential = {
		has_ascension_perk = ap_hyperdimensional_exodus
		has_country_flag = ssh_hyperdim_exodus_special_project_4_complete
	}
	weight = 0 #@tier5weight1
	is_dangerous = yes
	prereqfor_desc = {
		ship = {
			title = "ssh_certain_worth_it"
		}
	}

	modifier = {
		planet_jobs_produces_mult = 0.15
		country_sr_dark_matter_produces_mult = 0.25
	}

	ai_weight = {
		factor = 9999
		modifier = { 
			factor = 0 
			has_utopia = no 
		}
	}
}

ssh_tech_basement_universe = {
	cost = 60000
	area = physics
	tier = 5
	category = { field_manipulation }
	prerequisites = { "ssh_tech_elementary_tampering" "tech_disruptors_3" }
	weight = @tier5weight2
	is_rare = yes

	prereqfor_desc = { ship = { title = "ssh_basement_universe_tooltip" } }

	modifier = {
		pop_physicist_bonus_workforce_mult = 0.15
		#planet_researchers_physics_research_produces_add = 0.5
	}

	weight_modifier = {
		modifier = {
			factor = @ap_technological_ascendancy_rare_tech
			has_ascension_perk = ap_technological_ascendancy
		}
		modifier = { 
			factor = value:tech_weight_likelihood
			has_trait_in_council = { TRAIT = leader_trait_expertise_field_manipulation } 
		}
		modifier = { 
			factor = 0 
			has_utopia = no 
		}
	}

	ai_weight = {
		factor = 50
		modifier = { 
			factor = value:tech_weight_likelihood 
			has_trait_in_council = { TRAIT = leader_trait_expertise_field_manipulation } 
		}
		modifier = { 
			factor = 0 
			has_utopia = no 
		}
	}
}

# Electromagnetic Force Field Deactivation (System Disintegrator Mega)
ssh_tech_system_disintegrator = {
	cost = @ssh_tech_tier_f_mega_cost
	area = physics
	tier = 5
	category = { field_manipulation }
	prerequisites = { "ssh_tech_basement_universe" }
	weight = @tier5weight1
	is_rare = yes
	is_dangerous = yes

	#modifier = {
	#	country_physics_tech_research_speed = 0.15
	#	ship_ftl_jumpdrive_range_mult = 0.1
	#}

	weight_modifier = {
		modifier = {
			factor = @ap_technological_ascendancy_rare_tech
			has_ascension_perk = ap_technological_ascendancy
		}
		modifier = { 
			factor = value:tech_weight_likelihood
			has_trait_in_council = { TRAIT = leader_trait_expertise_field_manipulation } 
		}
		modifier = { 
			factor = 0 
			has_utopia = no 
		}
	}

	ai_weight = {
		factor = 50
		modifier = { 
			factor = value:tech_weight_likelihood 
			has_trait_in_council = { TRAIT = leader_trait_expertise_field_manipulation } 
		}
		modifier = { 
			factor = 0 
			has_utopia = no 
		}
	}
}

# Artificial Solar System Creation
ssh_tech_system_creator = {
	cost = @ssh_tech_tier_f_mega_cost #50000
	area = physics
	tier = 5
	category = { particles }
	prerequisites = { "ssh_tech_hydrogen" "ssh_tech_elementary_tampering" }
	weight = @tier5weight1
	is_rare = yes

	potential = {
		has_ascension_perk = ap_galactic_hyperstructures
	}

	#modifier = {
	#	country_physics_tech_research_speed = 0.15
	#	ship_ftl_jumpdrive_range_mult = 0.1
	#}

	weight_modifier = {
		modifier = {
			factor = @ap_technological_ascendancy_rare_tech
			has_ascension_perk = ap_technological_ascendancy
		}
		modifier = { 
			factor = value:tech_weight_likelihood
			has_trait_in_council = { TRAIT = leader_trait_expertise_particles } 
		}
		modifier = { 
			factor = 0 
			has_utopia = no
		}
	}

	ai_weight = {
		factor = 50
		modifier = { 
			factor = value:tech_weight_likelihood 
			has_trait_in_council = { TRAIT = leader_trait_expertise_particles } 
		}
		modifier = { 
			factor = 0 
			has_utopia = no 
		}
	}
}

ssh_tech_vr = {
	cost = 50000
	area = physics
	tier = 4
	category = { computing }
	prerequisites = { "tech_dyson_sphere" }
	weight = @tier4weight2
	is_rare = yes

	potential = {
		# Has researched positronic AI or the gestalt equivalent
		OR = {
			has_technology = tech_sapient_ai
			has_technology = tech_positronic_implants
			has_technology = tech_positronic_implants_machine_intelligence
		}
	}

	prereqfor_desc = {
		ship = {
			title = "ssh_vr_tooltip"
			desc = "ssh_vr_tooltip_desc"
		}
	}

	modifier = {
		planet_researchers_physics_research_produces_mult = 0.1
	}

	weight_modifier = {
		modifier = {
			factor = @ap_technological_ascendancy_rare_tech
			has_ascension_perk = ap_technological_ascendancy
		}
		modifier = { 
			factor = value:tech_weight_likelihood
			has_trait_in_council = { TRAIT = leader_trait_expertise_computing } 
		}
		modifier = { 
			factor = 0 
			has_utopia = no 
		}
	}

	ai_weight = {
		factor = 50
		modifier = { 
			factor = value:tech_weight_likelihood 
			has_trait_in_council = { TRAIT = leader_trait_expertise_computing } 
		}
		modifier = { 
			factor = 0 
			has_utopia = no 
		}
	}
}

ssh_tech_horizon_brain = {
	cost = @ssh_tech_tier_f_mega_cost #45000
	area = physics
	tier = 4
	category = { computing }
	prerequisites = { "ssh_tech_vr" "ssh_tech_nuclei_modification" }
	potential = {
		has_ascension_perk = ap_galactic_hyperstructures
		OR = {
			has_ascension_perk = ap_the_flesh_is_weak
			has_ascension_perk = ap_organo_machine_interfacing
			has_ascension_perk = ap_organo_machine_interfacing_assimilator
			has_ascension_perk = ap_synthetic_evolution
			has_ascension_perk = ap_synthetic_age
		}
	}
	weight = @tier4weight1
	is_rare = yes

	weight_modifier = {
		modifier = {
			factor = @ap_technological_ascendancy_rare_tech
			has_ascension_perk = ap_technological_ascendancy
		}
		modifier = {
			factor = @federation_perk_factor
			has_federation = yes
			federation = {
				has_federation_perk = rare_tech_boost
				any_member = { has_technology = ssh_tech_horizon_brain }
			}
		}
		modifier = { 
			factor = value:tech_weight_likelihood 
			has_trait_in_council = { TRAIT = leader_trait_expertise_computing } 
		}
		modifier = { 
			factor = 0 
			has_utopia = no 
		}
	}
	ai_weight = {
		factor = 25
		modifier = { 
			factor = value:tech_weight_likelihood 
			has_trait_in_council = { TRAIT = leader_trait_expertise_computing } 
		}
		modifier = { 
			factor = 0 
			has_utopia = no 
		}
	}
}

ssh_tech_pk_basement_universe = {
	area = physics
	cost = @tier5cost3
	tier = 5
	is_rare = yes
	is_reverse_engineerable = no
	category = { field_manipulation }
	prerequisites = { "ssh_tech_basement_universe" }
	potential = {
		host_has_dlc = Apocalypse
		has_country_flag = colossus_project
	}
	ai_update_type = military
	weight = @tier5weight3

	weight_modifier = {
		factor = 0.50
		inline_script = {
			script = technologies/rare_technologies_weight_modifiers
			TECHNOLOGY = tech_pk_shielder
		}
		modifier = {
			factor = 0.20
			NOR = {
				has_trait_in_council = { TRAIT = leader_trait_maniacal }
				has_trait_in_council = { TRAIT = leader_trait_maniacal_2 }
				has_trait_in_council = { TRAIT = leader_trait_maniacal_3 }
				has_trait_in_council = { TRAIT = leader_trait_curator }
				has_trait_in_council = { TRAIT = leader_trait_expertise_field_manipulation }
			}
		}
		modifier = {
			factor = 2
			is_pacifist = yes
		}
		modifier = {
			factor = 2
			is_materialist = yes
		}
	}

	ai_weight = {
		factor = 0.5
		modifier = {
			factor = 2
			OR = {
				has_ethic = ethic_pacifist
				has_ethic = ethic_materialist
			}
		}
		modifier = {
			factor = 5
			OR = {
				has_ethic = ethic_fanatic_pacifist
				has_ethic = ethic_fanatic_materialist
			}
		}
	}
}

ssh_tech_captive_star = {
	cost = @ssh_tech_tier_f_mega_cost
	area = physics
	tier = 5
	category = { field_manipulation }
	prerequisites = { "tech_dyson_sphere" }
	potential = {
		has_technology = tech_dyson_sphere
		NOT = { has_global_flag = ssh_captive_star_deactivated }
	}
	weight = @tier5weight1
	is_rare = yes

	weight_modifier = {
		modifier = {
			factor = @ap_technological_ascendancy_rare_tech
			has_ascension_perk = ap_technological_ascendancy
		}
		modifier = {
			factor = @federation_perk_factor
			has_federation = yes
			federation = {
				has_federation_perk = rare_tech_boost
				any_member = { has_technology = ssh_tech_captive_star }
			}
		}
		modifier = { 
			factor = value:tech_weight_likelihood 
			has_trait_in_council = { TRAIT = leader_trait_expertise_field_manipulation } 
		}
		modifier = { 
			factor = 1.25
			any_owned_megastructure = {
				OR = {
					is_megastructure_type = dyson_sphere_5
					is_megastructure_type = dyson_sphere_restored
					is_megastructure_type = dyson_sphere_disco
					is_megastructure_type = dyson_sphere_disco_restored
					is_megastructure_type = stellar_harvester_active
				}
			}
		}
		modifier = { 
			factor = 0 
			has_utopia = no 
		}
	}
	ai_weight = {
		factor = 250
		modifier = { 
			factor = value:tech_weight_likelihood 
			has_trait_in_council = { TRAIT = leader_trait_expertise_field_manipulation } 
		}
		modifier = { 
			factor = 0 
			has_utopia = no 
		}
		modifier = {
			factor = 0.5
			OR = {
				is_pacifist = yes
				is_ecocentric = yes
			}
		}
	}
}

# Dark Warheads
ssh_tech_dark_warhead = {
	cost = 50000 # Same as dark matter propulsion and other dark matter techs
	area = physics
	tier = 4
	category = { particles }
	prerequisites = { "tech_mine_dark_matter" "ssh_tech_nuclei_modification" "tech_missiles_4" }
	weight = @tier4weight2
	is_rare = yes
	is_dangerous = yes

	potential = {
		# Has researched at least one Dark Matter Ship Component Tech
		OR = {
			has_technology = tech_dark_matter_power_core
			has_technology = tech_dark_matter_deflector
			has_technology = tech_dark_matter_propulsion
			has_technology = tech_dark_matter_detection
		}
		NOT = { has_global_flag = ssh_dark_missile_deactivated }
	}

	weight_modifier = {
		modifier = {
			factor = @ap_technological_ascendancy_rare_tech
			has_ascension_perk = ap_technological_ascendancy
		}
		modifier = { 
			factor = value:tech_weight_likelihood
			has_trait_in_council = { TRAIT = leader_trait_expertise_particles } 
		}
		modifier = { 
			factor = 1.5
			any_country = { has_technology = ssh_tech_dark_warhead }
		}
		modifier = { 
			factor = 0 
			has_utopia = no 
		}
		modifier = { 
			factor = 0 
			NOT = { host_has_dlc = "Nemesis" }
		}
	}

	ai_weight = {
		factor = 175
		modifier = { 
			factor = value:tech_weight_likelihood 
			has_trait_in_council = { TRAIT = leader_trait_expertise_particles } 
		}
		modifier = { 
			factor = 1.5
			any_country = { has_technology = ssh_tech_dark_warhead }
		}
		modifier = { 
			factor = 2
			is_militarist = yes
		}
		modifier = { 
			factor = 0.25
			is_pacifist = yes
		}
		modifier = { 
			factor = 0 
			has_utopia = no 
		}
		modifier = { 
			factor = 0 
			NOT = { host_has_dlc = "Nemesis" }
		}
	}
}

# Advanced Dark Yields (Stabilized Dark Warheads)
ssh_tech_dark_warhead_yields = {
	cost = 50000
	area = physics
	tier = 4
	category = { particles }
	prerequisites = { "ssh_tech_dark_warhead" }
	weight = @tier4weight2
	is_rare = yes
	#is_dangerous = yes

	potential = {
		has_technology = ssh_tech_dark_warhead
		has_global_flag = ssh_large_dark_missile_activated
	}

	weight_modifier = {
		modifier = {
			factor = @ap_technological_ascendancy_rare_tech
			has_ascension_perk = ap_technological_ascendancy
		}
		modifier = { 
			factor = value:tech_weight_likelihood
			has_trait_in_council = { TRAIT = leader_trait_expertise_particles } 
		}
		modifier = { 
			factor = 1.5
			any_country = { has_technology = ssh_tech_dark_warhead_yields }
		}
		modifier = { 
			factor = 0 
			has_utopia = no 
		}
		modifier = { 
			factor = 0 
			NOT = { host_has_dlc = "Nemesis" }
		}
	}

	ai_weight = {
		factor = 175
		modifier = { 
			factor = value:tech_weight_likelihood 
			has_trait_in_council = { TRAIT = leader_trait_expertise_particles } 
		}
		modifier = { 
			factor = 1.5
			any_country = { has_technology = ssh_tech_dark_warhead_yields }
		}
		modifier = { 
			factor = 2
			is_militarist = yes
		}
		modifier = { 
			factor = 0.25
			is_pacifist = yes
		}
		modifier = { 
			factor = 0 
			has_utopia = no 
		}
		modifier = { 
			factor = 0 
			NOT = { host_has_dlc = "Nemesis" }
		}
	}
}